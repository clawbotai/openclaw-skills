# 2026-02-12 Session Notes

## Product Drawing Cleanup
- Stripped LKK SCM firm info, drawing numbers (T010-03-03), "Needle OD" spec tables, border labels from both isobar and poise technical drawings
- Lesson learned: **debug image coordinates with red marker first** before white-filling. Took 4+ blind attempts before using debug rectangle to find exact positions.
- Isobar crop: `(200, 300, 3150, 1470)` from 3308x2339 original
- Poise crop: `(100, 50, 3250, 1580)` from 3308x2339; white-out drawing number at `(0,0,500,100)` cropped coords; size table at `(2100,830,2850,1010)` cropped coords
- Both resized to 800px wide for web

## Website v3.3 — Address Intelligence
- Country field: `<select>` with all DHL-supported destinations (180+ countries)
- State/region + city: `<datalist>` suggestions via countriesnow.space API (cached)
- US ZIP autofill via api.zippopotam.us → auto-populates state + city
- City filtering: type "tok" in Japan → shows Tokyo/Tokushima etc.
- Hardcoded state data for US (50+DC), Canada (13), Australia (8), Japan (47 prefectures)
- Commit: `e8388b0`

## Birthday Banner (temporary demo)
- Added/removed celebration banner for Christian as a demo to friends
- Banner required `position:fixed; z-index:2000` + body class `has-celebration` to offset header by 56px
- Commits: `d6db418` (add), `7b8179b` (fix visibility), `8b26001` (revert/remove)

## Website v3.4 — Interactive Tolerances + Order Tracking
- **Tolerance overlays**: SHOW TOLERANCES button on each product drawing image
  - ISOBAR callouts: flow channel ±0.01, dual-lock seal ±0.02, vent array ΔP<0.3Pa
  - POISE callouts: gauge OD ±0.01, thread register ±0.02, 5-bevel tip 8°±0.2°
  - CSS: glassmorphism cards with `position:absolute` using % coordinates, `transform:translate(-50%,-50%)`
- **Order tracker modal**: TRACK button in nav, full-screen overlay
  - Queries `/api/status` for live blockchain status
  - 6-step visual timeline: created→pending→detected→confirming→confirmed→shipped
  - TX hash links to Etherscan
  - USE CURRENT ORDER auto-fills from active checkout
  - ORDER REF block appears during payment with direct tracker link
  - Escape key closes tracker (highest priority in key handler chain)
- Commit: `9b59364`

## Ecommerce Architecture Plan (approved by Steven)
- Full OMS architecture designed for torrstatics.com:
  - **Client accounts**: passwordless magic-link auth + wallet-signature
  - **Order management**: full lifecycle with immutable event ledger
  - **Order history UX**: dashboard, timeline, reorder, invoice downloads
  - **Admin console**: internal order management, role-based
  - **Data model**: D1 tables (users, addresses, orders, order_items, order_events)
  - **Stack**: Cloudflare Workers + D1 + KV + R2 + Durable Objects
- Steven said "start" — began Phase 1 implementation

## BLOCKED: Cloudflare API Token Permissions
- Existing `CLOUDFLARE_API_TOKEN` lacks D1 permissions (only has Pages + KV)
- Need new token with: D1 Edit, Workers Scripts Edit, Workers KV Edit, Pages Edit
- Asked Steven to create via dashboard at https://dash.cloudflare.com/profile/api-tokens using "Edit Cloudflare Workers" template + D1 Edit
- **Cannot proceed with D1 database provisioning until token is provided**

## Key State
- Website at https://torrstatics.com — v3.4 live (commit `9b59364`)
- GitHub: `clawbotai/torr-statics` (private)
- 15 skills in workspace
- Hetzner manual verification still pending
- All product prices still $1 for testing
